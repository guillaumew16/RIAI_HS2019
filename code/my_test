#!/bin/bash

# a little script for quick and dirty testing.

if [[ $# -ne 2 ]]; then
	echo "Usage: my_test <net> <v || nv> (verbose or not-verbose)"
	exit 0
else
	if [[ $1 == "v" ]]; then
        verbosity="--myverbose"
    elif [[ $1 == "nv" ]]; then
        verbosity=""
    else
        echo "Usage: my_test <net> <v || nv> (verbose or not-verbose)"
        exit 0
    fi
    net=$2
fi

if [[ ${net} == "fc1" ]]; then
    spec="img1_0.07500.txt"
elif [[ ${net} == "fc2" ]]; then
    spec="img1_0.04100.txt"
# elif [[ ${net} == "fc3" ]]; then # TODO: copy the filenames for the others
# elif [[ ${net} == "fc4" ]]; then
# elif [[ ${net} == "fc5" ]]; then
elif [[ ${net} == "conv1" ]]; then
    spec="img0_0.00200.txt"
# elif [[ ${net} == "conv2" ]]; then
# elif [[ ${net} == "conv3" ]]; then
# elif [[ ${net} == "conv4" ]]; then
# elif [[ ${net} == "conv5" ]]; then
else
    echo "Usage: my_test <net> <v || nv> (verbose or not-verbose)"
    echo -e "\tnet must be one of: fc1 fc2 fc3 fc4 fc5 conv1 conv2 conv3 conv4 conv5"
    echo -e "\tonly fc1 fc2 conv5 supported for now"
    exit 0
fi

t=3 # timeout

echo "Evaluating network ${net}..."
echo -ne "\ttest_cases/${net}/${spec}: \t"
timeout ${t}s python verifier.py --net ${net} --spec ../test_cases/${net}/${spec} ${verbosity} || echo "timed out (or error)"
